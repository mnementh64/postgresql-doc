



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="PostgreSQL doc">
      
      
      
        <meta name="author" content="Sylvain Caillet">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.7.0">
    
    
      
        <title>Performance with PostgreSQL - PostgreSQL doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#performance-with-postgresql" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="PostgreSQL doc" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                PostgreSQL doc
              </span>
              <span class="md-header-nav__topic">
                Performance with PostgreSQL
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    PostgreSQL doc
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mvcc/" title="MVCC model" class="md-nav__link">
      MVCC model
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../cache_system/" title="Cache system" class="md-nav__link">
      Cache system
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../wal_files/" title="Wal files" class="md-nav__link">
      Wal files
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../checkpoints/" title="Checkpoints" class="md-nav__link">
      Checkpoints
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../autovacuum/" title="Autovacuum" class="md-nav__link">
      Autovacuum
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../statistics/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../monitoring/" title="Monitoring" class="md-nav__link">
      Monitoring
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Performance with PostgreSQL
      </label>
    
    <a href="./" title="Performance with PostgreSQL" class="md-nav__link md-nav__link--active">
      Performance with PostgreSQL
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tuning-postgresql" title="Tuning PostgreSQL" class="md-nav__link">
    Tuning PostgreSQL
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-separate-disks" title="Use separate disks" class="md-nav__link">
    Use separate disks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronous-commit" title="Synchronous commit" class="md-nav__link">
    Synchronous commit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal-write-method" title="WAL write method" class="md-nav__link">
    WAL write method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mastering-checkpoints" title="Mastering Checkpoints" class="md-nav__link">
    Mastering Checkpoints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autovacuum" title="Autovacuum" class="md-nav__link">
    Autovacuum
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyze" title="Analyze" class="md-nav__link">
    Analyze
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-buffers" title="Shared buffers" class="md-nav__link">
    Shared buffers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-planner" title="Query planner" class="md-nav__link">
    Query planner
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-linux" title="Tuning Linux" class="md-nav__link">
    Tuning Linux
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../query_optimizations/" title="Query optimizations" class="md-nav__link">
      Query optimizations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../table_design/" title="Table design" class="md-nav__link">
      Table design
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../other_points/" title="Other points" class="md-nav__link">
      Other points
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../linux_tuning/" title="Linux tuning" class="md-nav__link">
      Linux tuning
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../useful-tools/" title="Useful tools" class="md-nav__link">
      Useful tools
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../useful-scripts/" title="Useful scripts" class="md-nav__link">
      Useful scripts
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tuning-postgresql" title="Tuning PostgreSQL" class="md-nav__link">
    Tuning PostgreSQL
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-separate-disks" title="Use separate disks" class="md-nav__link">
    Use separate disks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronous-commit" title="Synchronous commit" class="md-nav__link">
    Synchronous commit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal-write-method" title="WAL write method" class="md-nav__link">
    WAL write method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mastering-checkpoints" title="Mastering Checkpoints" class="md-nav__link">
    Mastering Checkpoints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autovacuum" title="Autovacuum" class="md-nav__link">
    Autovacuum
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyze" title="Analyze" class="md-nav__link">
    Analyze
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-buffers" title="Shared buffers" class="md-nav__link">
    Shared buffers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-planner" title="Query planner" class="md-nav__link">
    Query planner
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-linux" title="Tuning Linux" class="md-nav__link">
    Tuning Linux
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="performance-with-postgresql">Performance with PostgreSQL<a class="headerlink" href="#performance-with-postgresql" title="Permanent link">&para;</a></h1>
<p>Tuning the server is worth as the expected activity is not standard : heavy workload, bulk reads, high number of clients, ...</p>
<p>Standard advices and understanding to tune PostgreSQL for performance could be found <a href="https://www.2ndquadrant.com/media/pdfs/talks/MonitoringBufferCache.pdf">here</a>, written by the great Greg Smith itself.</p>
<p>A friend of him also answer <a href="https://stackoverflow.com/questions/9407442/optimise-postgresql-for-fast-testing">this post</a> with great details !</p>
<p>Good advices also <a href="http://pydanny-event-notes.readthedocs.io/en/latest/DjangoConEurope2012/10-steps-to-better-postgresql-performance.html">there</a>.</p>
<p>Level of optimizations are mainly four :</p>
<ul>
<li>OS, hardware</li>
<li>PostgreSQL configuration</li>
<li>database design</li>
<li>software, model and queries</li>
</ul>
<h2 id="tuning-postgresql">Tuning PostgreSQL<a class="headerlink" href="#tuning-postgresql" title="Permanent link">&para;</a></h2>
<h4 id="use-separate-disks">Use separate disks<a class="headerlink" href="#use-separate-disks" title="Permanent link">&para;</a></h4>
<p>It's important to use separate disks for :</p>
<ul>
<li>data : <code>data_directory = '/var/lib/postgresql/9.6/main'</code> in <code>postgresql.conf</code></li>
<li>wal : only way by symbolic link ?</li>
<li>wal archives if activated</li>
<li>logs : only way by symbolic link ?</li>
</ul>
<h4 id="synchronous-commit">Synchronous commit<a class="headerlink" href="#synchronous-commit" title="Permanent link">&para;</a></h4>
<p><code>postgresql.conf</code>'s parameter <code>synchronous_commit=on</code> define the commit method used. If ON, it waits for WAL files to be written to disk before acknowledge client query. Depending on HDD type, it could introduce some latency.</p>
<p>Setting this parameter do not harm data coherence but in case of server crash before last commit were written to disk, they could be lost. It doesn't matter in most of cases !</p>
<p>See this <a href="https://blog.2ndquadrant.com/evolution-fault-tolerance-postgresql-synchronous-commit/">blog post</a> for details.</p>
<p>Other citation : <code>This is one of the most known Postgres performance tweaks</code>.   </p>
<h4 id="wal-write-method">WAL write method<a class="headerlink" href="#wal-write-method" title="Permanent link">&para;</a></h4>
<p>The tool <code>pg_test_fsync</code> packaged with PostgreSQL could be useful to verify if the default value for the <code>postgres.conf</code> parameter <code>wal_sync_method</code> is the more efficient (<code>fdatasync</code> by default on Linux OS).</p>
<p>The tool will execute some checks to output write stats with all avalaible methods (see <a href="../postgresql/useful-tools/#pg_test_fsync">details</a>) :</p>
<div class="codehilite"><pre><span></span>./pg_test_fsync

5 seconds per test
O_DIRECT supported on this platform for open_datasync and open_sync.

Compare file sync methods using one 8kB write:
(in wal_sync_method preference order, except fdatasync is Linux&#39;s default)
        open_datasync                      1002.075 ops/sec     998 usecs/op
        fdatasync                          1062.147 ops/sec     941 usecs/op
        fsync                               597.879 ops/sec    1673 usecs/op
        fsync_writethrough                            n/a
        open_sync                            34.400 ops/sec   29070 usecs/op

Compare file sync methods using two 8kB writes:
(in wal_sync_method preference order, except fdatasync is Linux&#39;s default)
        open_datasync                       688.196 ops/sec    1453 usecs/op
        fdatasync                          1045.286 ops/sec     957 usecs/op
        fsync                               588.164 ops/sec    1700 usecs/op
        fsync_writethrough                            n/a
        open_sync                            25.560 ops/sec   39123 usecs/op

Compare open_sync with different write sizes:
(This is designed to compare the cost of writing 16kB in different write
open_sync sizes.)
         1 * 16kB open_sync write            46.153 ops/sec   21667 usecs/op
         2 *  8kB open_sync writes           16.677 ops/sec   59964 usecs/op
         4 *  4kB open_sync writes            2.985 ops/sec  334965 usecs/op
         8 *  2kB open_sync writes            1.169 ops/sec  855245 usecs/op
        16 *  1kB open_sync writes            0.350 ops/sec  2860294 usecs/op

Test if fsync on non-write file descriptor is honored:
(If the times are similar, fsync() can sync data written on a different
descriptor.)
        write, fsync, close                 626.905 ops/sec    1595 usecs/op
        write, close, fsync                 681.045 ops/sec    1468 usecs/op

Non-sync&#39;ed 8kB writes:
        write                            357014.644 ops/sec       3 usecs/op
</pre></div>


<h4 id="mastering-checkpoints">Mastering Checkpoints<a class="headerlink" href="#mastering-checkpoints" title="Permanent link">&para;</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What is it ? Some <a href="../postgresql/checkpoints/">details</a>.</p>
</div>
<p>Default value of 5mn for checkpoints and 0.5 for the available fraction of this time to do the writing is not good for heavy workload usage.</p>
<p>We must set the checkpoint time to at least 30mn and maybe a lot of more, 90mn can be good. </p>
<p>Anyway, once this time is decided, we have to know the amount of produced WAL files. </p>
<p>Imagine we would like to set the value as :</p>
<div class="codehilite"><pre><span></span>checkpoint_timeout = 30min
</pre></div>


<p>Let's execute the following queries to get basic knowledge about the server activity :</p>
<div class="codehilite"><pre><span></span>postgres=# SELECT pg_current_xlog_insert_location();
 pg_current_xlog_insert_location 
---------------------------------
 3D/B4020A58
(1 row)

... after 5 minutes ...

postgres=# SELECT pg_current_xlog_insert_location();
 pg_current_xlog_insert_location 
---------------------------------
 3E/2203E0F8
(1 row)

postgres=# SELECT pg_xlog_location_diff(&#39;3E/2203E0F8&#39;, &#39;3D/B4020A58&#39;);
 pg_xlog_location_diff 
-----------------------
            1845614240
(1 row)
</pre></div>


<p>So, every 5mn, ~1.8GB of WAL files is produced, that is 10GB for 30mn. But the <code>max_wal_size</code> must be set for 3 checkpoints, so tune it to <strong>30GB</strong>.</p>
<p>It's a good habit to let the checkpoint a good amount of time to write its stuff to disk. Evaluate the <code>checkpoint_completion_target</code> value as :</p>
<div class="codehilite"><pre><span></span>checkpoint_completion_target = (checkpoint_timeout - 2min) / checkpoint_timeout
And no more then 0.9
</pre></div>


<p>For 30mn checkpoints, it's 0.9, that means checkpoint process have 0.9*30=27mn to write data befroe complete the checkpoint.</p>
<p>Finally, activate the log to monitor the checkpoint activity :</p>
<div class="codehilite"><pre><span></span>log_checkpoint = on
</pre></div>


<p>By the way, there are many writing methods that could be used for WAL files. See <a href="../postgresql/pgsql_perf/#best-write-method">here</a> to find the best. The <code>wal_sync_method</code> parameter could be verified or changed by this way.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Monitor checkpoints <a href="../postgresql/statistics/#checkpoints">running statistics</a> to ensure the behavior is under control.</p>
</div>
<h4 id="autovacuum">Autovacuum<a class="headerlink" href="#autovacuum" title="Permanent link">&para;</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What is it ? Some <a href="../postgresql/autovacuum/">details</a>.</p>
</div>
<p><a href="https://blog.2ndquadrant.com/autovacuum-tuning-basics/">Good article</a> about tuning autovacuum, again in 2nd quadrant blog !</p>
<p>Remember standard configuration of autovacuum stands for standard usages. It needs to be tuned for specific purposes.</p>
<p>Many risks with autovacuum :</p>
<ul>
<li>too many writing in DB so autovacuum could not free space enough quick,</li>
<li>some tables have specific size and design that make the autovacuum job hard on them (like for timeseries). We could then observe <a href="../postgresql/autovacuum/#bloating">table bloating</a>,</li>
<li>bloating could be observed even on catalog tables (especially if there are a huge number of tables in schema) !</li>
<li>and many others I don't know !</li>
</ul>
<p>Autovacuum parameters are :</p>
<ul>
<li><code>autovacuum_max_workers</code> : (3 default) Could be increase for aggressive vacuum</li>
<li><code>autovacuum_naptime</code> : (1min default) minimum delay between autovacuum runs on any given database. Could be decrease for aggressive vacuum</li>
<li><code>autovacuum_vacuum_threshold</code> / <code>autovacuum_vacuum_scale_factor</code> : implied in autovacuum <a href="../postgresql/autovacuum/#what-trigger-autovacuum">trigger condition</a></li>
<li><code>autovacuum_analyze_threshold</code> / <code>autovacuum_analyze_scale_factor</code> : implied in autoanalyze <a href="../postgresql/autovacuum/#analyze">trigger condition</a></li>
<li><code>autovacuum_vacuum_cost_delay</code> : (20ms default) delay the process will sleep when the cost limit has been exceeded. Could be decrease for aggressive vacuum</li>
<li><code>autovacuum_vacuum_cost_limit</code> : (-1 means use vacuum_cost_limit value which is 200 default) arbitrary cost vacuums should not exceed. Coud be increase for aggressive vacuum</li>
</ul>
<p>On big tables, default behavior should be customized table by table : </p>
<div class="codehilite"><pre><span></span><span class="c1">-- reduce the scale factor (default is 0.2 , that is 20%)</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="n">tablename</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="n">autovacuum_vacuum_scale_factor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">;</span>
</pre></div>


<p>For a million-row table this means autovacuum would start after ten thousand rows are invalidated rather than two hundred thousand. It helps stopping bloat from getting out of control.</p>
<p>Even more aggresive for some of the largest tables :</p>
<div class="codehilite"><pre><span></span>ALTER TABLE table_name SET (autovacuum_vacuum_scale_factor = 0.0);
ALTER TABLE table_name SET (autovacuum_vacuum_threshold = 5000);
ALTER TABLE table_name SET (autovacuum_analyze_scale_factor = 0.0);
ALTER TABLE table_name SET (autovacuum_analyze_threshold = 5000);
</pre></div>


<p>Autovacuum will be triggered every 5000 inserts, updates, or deletes.</p>
<div class="admonition advice">
<p class="admonition-title">Advice</p>
<p>It's better autovacuum work more often and does less work than less often and does more work.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Monitor <a href="../postgresql/statistics/#autovacuum">vacuum efficiency</a> to ensure the behavior is under control.</p>
</div>
<h4 id="analyze">Analyze<a class="headerlink" href="#analyze" title="Permanent link">&para;</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What is it ? Some <a href="../postgresql/autovacuum/#analyze">details</a>.</p>
</div>
<p>The default behavior of automatic process rely only on how many row have been inserted or updated, so depending of chat kind of data each column keep, it could be interesting to launch manual ANALYZE in some specific cases.</p>
<p>ANALYZE behavior could be tuned by changing the <code>default_statistics_target = 100</code> parameter which tells the analyze process how many rows of each table it must sample to compute stats. The greater this number is, the better stats are but it costs more in computation ! </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Monitor <a href="../postgresql/statistics/#autovacuum">analyze efficiency</a></p>
</div>
<h4 id="shared-buffers">Shared buffers<a class="headerlink" href="#shared-buffers" title="Permanent link">&para;</a></h4>
<p>An excellent example of analyzing stats from background writer / checkpoint and shared buffer could be found in <a href="https://forums.postgresql.fr/viewtopic.php?id=2783">this post</a>.</p>
<p>Shared buffers should be :</p>
<ul>
<li>large enough to ensure the checkpointer process is mainly responsible for the buffer writing to disk (monitor who does the write)</li>
<li>not too large so checkpoint could handle the writing in the time allowed</li>
</ul>
<p>The basic tuning is 25% of the RAM on a dedicated server.</p>
<p>But how compute the more efficient RAM size it needs ?</p>
<h4 id="query-planner">Query planner<a class="headerlink" href="#query-planner" title="Permanent link">&para;</a></h4>
<p>The parameter <code>random_page_cost</code> sets the planner's estimate of the cost of a non-sequentially-fetched disk page , like fetching blocks using the index.</p>
<p>Its default value of 4.0 is quite high for modern storage system.</p>
<p>See <a href="https://wiki.postgresql.org/wiki/Tuning_Your_PostgreSQL_Server">PostgreSQL Wiki</a> for more details. The official <a href="https://www.postgresql.org/docs/current/static/runtime-config-query.html#GUC-RANDOM-PAGE-COST">PostgreSQL documentation</a> page tells to also tune the other parameter <code>seq_page_cost</code> mostly to the same value.  </p>
<h2 id="tuning-linux">Tuning Linux<a class="headerlink" href="#tuning-linux" title="Permanent link">&para;</a></h2>
<p>See details on <a href="../postgresql/linux_tuning/">the dedicated page</a>.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../monitoring/" title="Monitoring" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Monitoring
              </span>
            </div>
          </a>
        
        
          <a href="../query_optimizations/" title="Query optimizations" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Query optimizations
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            free
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>